import{a as D}from"./chunk-BAYCJSBC.js";import{j as x}from"./chunk-76THLDRW.js";import{G as l,Ja as S,M as _,Na as b,S as y,Va as n,Ya as k,Za as C,_a as j,bb as m,gb as T,nb as w,o as u,p,pb as I,r as c,t as v,u as g}from"./chunk-FG5CMVYC.js";var L={formId:"article",title:"Article",components:[{name:"Text",key:"title",focused:!0,fields:[{name:"Placeholder",value:"fill article title"},{name:"Label",value:"Title"}]},{name:"Text",key:"link",fields:[{name:"Placeholder",value:"fill article link"},{name:"Label",value:"Link"}]},{name:"Text",key:"video",fields:[{name:"Placeholder",value:"fill article video"},{name:"Label",value:"Video"}]},{name:"Text",key:"shortDescription",fields:[{name:"Placeholder",value:"fill articles short description"},{name:"Label",value:"Short Description"}]},{name:"Photo",key:"thumb",fields:[{name:"Label",value:"Thumb"}]},{name:"TinyMCE",key:"description",fields:[{name:"Placeholder",value:"fill articles description"},{name:"Label",value:"Description"}]},{name:"Date",key:"published",fields:[{name:"Label",value:"Date"}]},{name:"Select",key:"tags",fields:[{name:"Items",value:[]},{name:"Placeholder",value:"Select tags"},{name:"Label",value:"Tags"},{name:"Multiple",value:!0}]}]};var F=(()=>{let e=class e extends k{constructor(r,i,t,s){super({name:"article"},r,i,t,s),this.articles=this.getDocs(),this.articlesByTag={},this.get(),this.filteredDocuments(this.articlesByTag,"tags")}};e.\u0275fac=function(i){return new(i||e)(c(j),c(C),c(m),c(n))},e.\u0275prov=u({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var d=(()=>{let e=class e{get rows(){return this.tag?this._articleService.articlesByTag[this.tag]:this._articleService.articles}constructor(r,i,t,s,h,P,A){this._translate=r,this._articleService=i,this._ats=t,this._alert=s,this._form=h,this._core=P,this._router=A,this.columns=["title"],this.tag=this._router.url.includes("/articles/")?this._router.url.replace("/articles/",""):"",this.form=this._form.getForm("article",L),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(a,f)=>{this._preCreate(a),this._articleService.create(a),f()}},this.tag?{tags:[this.tag]}:{})},update:a=>{this._form.modal(this.form,[],a).then(f=>{this._core.copy(f,a),this._articleService.update(a)})},delete:a=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this article?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._articleService.delete(a)}}]})},buttons:[{icon:"cloud_download",click:a=>{this._form.modalUnique("article","url",a)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.form.components[7].fields?.length&&(this.form.components[7].fields[0].value=this._ats.articletags)}_bulkManagement(r=!0){return()=>{this._form.modalDocs(r?[]:this.rows).then(i=>{if(r)for(let t of i)this._preCreate(t),this._articleService.create(t);else{for(let t of this.rows)i.find(s=>s._id===t._id)||this._articleService.delete(t);for(let t of i){let s=this.rows.find(h=>h._id===t._id);s?(this._core.copy(t,s),this._articleService.update(s)):(this._preCreate(t),this._articleService.create(t))}}})}}_preCreate(r){r.__created,this.tag&&!r.tags?.length&&(r.tags=[this.tag])}};e.\u0275fac=function(i){return new(i||e)(l(T),l(F),l(D),l(m),l(I),l(n),l(S))},e.\u0275cmp=v({type:e,selectors:[["ng-component"]],decls:1,vars:3,consts:[["title","Articles",3,"columns","config","rows"]],template:function(i,t){i&1&&y(0,"wtable",0),i&2&&_("columns",t.columns)("config",t.config)("rows",t.rows)},dependencies:[w]});let o=e;return o})();var q=[{path:"",component:d},{path:":tag",component:d}],W=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=g({type:e}),e.\u0275inj=p({imports:[b.forChild(q),x]});let o=e;return o})();export{W as ArticlesModule};
